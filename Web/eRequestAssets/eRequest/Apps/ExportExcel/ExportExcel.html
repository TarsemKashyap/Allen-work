<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">
<head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="../_catalogs/masterpage/eRequest/Apps/StyleLib/Styles/Spinner.css" />
    <!-- ===== Layout Scripts in SharePoint  =========================================================================================== -->
    <script src="/_layouts/15/clientpeoplepicker.js"></script>
    <script src="/_layouts/15/clienttemplates.js"></script>
    <script src="/_layouts/15/clientforms.js"></script>
    <script src="/_layouts/15/sp.runtime.js"></script>
    <script src="/_layouts/15/autofill.js"></script>
    <script src="/_layouts/15/sp.js"></script>

    <script type="text/javascript" src="/_layouts/15/init.js"></script>
    <script type="text/javascript" src="/_layouts/15/1033/strings.js"></script>
    <script type="text/javascript" src="/_layouts/15/core.js"></script>

    <!-- ===== Custom Scripts in Master  =========================================================================================== -->
    <script src="../_catalogs/masterpage/eRequest/Apps/app.js"></script>
    <script src="../_catalogs/masterpage/eRequest/Apps/baseSvc.js"></script>
    <script src="../_catalogs/masterpage/eRequest/Apps/commonSvc.js"></script>
    <script src="../_catalogs/masterpage/eRequest/Apps/utility.js"></script>
    <script src="../_catalogs/masterpage/eRequest/Apps/ExportExcel/ExportExcelService.js"></script>
    <script src="../_catalogs/masterpage/eRequest/Apps/ExportExcel/ExportExcelController.js"></script>
    <script src="../_catalogs/masterpage/eRequest/Apps/StyleLib/Js/jquery.table2excel.min.js"></script>
    <!-- ===== Date Picker-jquery-ui.css  =========================================================================================== -->
    <style type="text/css">

        body {
            font-family: "Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif;
        }

        .container {
            width: 100% !important;
        }

        label {
            display: inline-block;
            /* max-width: 100%; */
            margin-bottom: 5px;
            font-weight: 500;
            /* text-align: left; */
            /* font-size: 12px; */
        }

        .odd {
            background-color: #afb5ff;
        }

        .even {
            background-color: #ccc;
        }

        .sort-icon {
            font-size: 9px;
            margin-left: 5px;
        }

        th {
            cursor: pointer;
        }

        .active {
            color: #023509 !important
        }

        h4, .ms-h4 {
            font-size: 1.7em;
            color: #262626;
        }
    </style>
    <style>

        .pagination a {
            color: black;
            float: left;
            padding: 8px 16px;
            text-decoration: none;
            transition: background-color .3s;
            border: 1px solid #ddd;
        }

            .pagination a.active {
                background-color: #4CAF50;
                color: white;
                border: 1px solid #4CAF50;
            }

            .pagination a:hover:not(.active) {
                background-color: #ddd;
            }
    </style>
    <style>
        .arrow {
            border: solid black;
            border-width: 0 3px 3px 0;
            display: inline-block;
            padding: 3px;
        }

        .right {
            transform: rotate(-45deg);
            -webkit-transform: rotate(-45deg);
        }

        .left {
            transform: rotate(135deg);
            -webkit-transform: rotate(135deg);
        }

        .up {
            transform: rotate(-135deg);
            -webkit-transform: rotate(-135deg);
        }

        .down {
            transform: rotate(45deg);
            -webkit-transform: rotate(45deg);
        }
    </style>
    <style>
        #ui-datepicker-div.ui-datepicker .ui-widget-header {
            border: 1px solid #aaa;
            background: #e9e9e9;
            color: #ffffff;
            font-weight: bold;
        }

            #ui-datepicker-div.ui-datepicker .ui-state-hover, #ui-datepicker-div.ui-datepicker.ui-widget-content .ui-state-hover, #ui-datepicker-div.ui-datepicker .ui-widget-header .ui-state-hover {
                border: 1px solid #ccc;
                background: #ededed;
                color: #2b2b2b;
            }

                #ui-datepicker-div.ui-datepicker .ui-state-hover .ui-icon {
                    background-image: url(images/ui-icons_222222_256x240.png)
                }

            #ui-datepicker-div.ui-datepicker .ui-widget-header .ui-icon {
                background-image: url(images/ui-icons_222222_256x240.png)
            }

        #ui-datepicker-div.ui-datepicker .ui-state-default, #ui-datepicker-div.ui-datepicker.ui-widget-content .ui-state-default {
            color: rgb(0,69,126);
        }

        #ui-datepicker-div.ui-datepicker .ui-widget-header select, #ui-datepicker-div.ui-datepicker.ui-helper-clearfix select {
            font-weight: normal;
            display: inline;
            height: auto;
            margin: 1px 0;
            padding: 0;
            -webkit-appearance: menulist;
            -moz-appearance: menulist;
            background-image: none;
        }

        #ui-datepicker-div.ui-datepicker .ui-datepicker-prev-hover, #ui-datepicker-div.ui-datepicker .ui-datepicker-next-hover {
            top: 2px;
        }

        #ui-datepicker-div.ui-datepicker .ui-datepicker-prev-hover {
            left: 2px;
        }

        #ui-datepicker-div.ui-datepicker .ui-datepicker-next-hover {
            right: 2px;
        }
    </style>
    <script>
        $(function () {
            var dateToday = new Date();
            $("#ApplicationDate").datepicker({
                changeMonth: true,
                changeYear: true,
                dateFormat: 'dd/mm/yy',
                //numberOfMonths: 2,
                autoclose: true,
                endDate: dateToday,
                //onSelect: function (date) {
                //Get selected date
                //  var date2 = $('#ApplicationDate').datepicker('getDate');
                //sets minDate to txt_date_to
                //   $('#ApplicationEndDate').datepicker('option', 'minDate', date2);
                //  }

            });
            $("#ApplicationEndDate").datepicker({
                changeMonth: true,
                changeYear: true,
                dateFormat: 'dd/mm/yy',
                autoclose: true
            });
        });
    </script>
</head>
<body>
    <div ng-app="eRequestApp">
        <div ng-controller="ExportExcelController" ng-init="init()">
            <ng-form name="appForm" ng-app novalidate>
                <!-- Main Section -->
                <div class="main-wrapper">
                    <!-- partial:partials/_sidebar.html -->
                    <nav class="sidebar">
                        <div class="sidebar-header">
                            <a href="#" class="sidebar-brand">
                                <img src="../_catalogs/masterpage/eRequest/Apps/StyleLib/Images/logo.png" alt="" class="img-fluid" style="padding:35px">
                            </a>
                            <div class="sidebar-toggler not-active">
                                <span></span>
                                <span></span>
                                <span></span>
                            </div>
                        </div>
                    </nav>
                    <!-- partial -->
                    <div class="page-wrapper">
                        <!-- partial:partials/_navbar.html -->
                        <nav class="navbar">
                            <a href="#" class="sidebar-toggler">
                                <i data-feather="menu"></i>
                            </a>
                            <div class="navbar-content" style="background-color: #fff;">
                                <ul class="navbar-nav">
                                    <li class="nav-item dropdown nav-profile">
                                        <a class="nav-link dropdown-toggle" href="#" id="profileDropdown" role="button" data-toggle="dropdown"
                                           aria-haspopup="true" aria-expanded="false">
                                            <img src="../_catalogs/masterpage/eRequest/Apps/StyleLib/Images/faces/face1.jpg" alt="profile">
                                        </a>
                                        <div class="dropdown-menu" aria-labelledby="profileDropdown">
                                            <div class="dropdown-header d-flex flex-column align-items-center">
                                                <div class="figure mb-3">
                                                    <img src="../_catalogs/masterpage/eRequest/Apps/StyleLib/Images/faces/face1.jpg" alt="">
                                                </div>
                                                <div class="info text-center">
                                                    <p class="name font-weight-bold mb-0">Hi {{appProperties.CurrentUser.Title}}</p>
                                                    <p class="email text-muted mb-3">{{appProperties.CurrentUser.Email}}</p>
                                                </div>
                                            </div>
                                            <div ng-show="isSiteAdmin" class="dropdown-body">
                                                <ul class="profile-nav p-0 pt-3">
                                                    <li class="nav-item">
                                                        <a target="_parent" href="/erequest/_layouts/15/viewlsts.aspx" class="nav-link">
                                                            <i data-feather="edit"></i>
                                                            <span>Site Contents</span>
                                                        </a>
                                                    </li>
                                                    <li class="nav-item">
                                                        <a target="_parent" href="/erequest/_layouts/15/settings.aspx" class="nav-link">
                                                            <i data-feather="log-out"></i>
                                                            <span>Site Settings</span>
                                                        </a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </nav>
                        <!-- partial -->
                        <div class="page-content">
                            <h4>Export Excel </h4>
                            <div class="tab-content" id="pills-tabContent">
                                <div class="row">
                                    <div class="col-md-12 grid-margin stretch-card">
                                        <div class="card">
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="column"> <label>Select List</label></div>
                                                    <div class="col-md-4 column">
                                                        <select style="display:none" name="ddlList" id="ddlList" ng-change="getListData(ListName)" class="form-control form-control-sm mb-3" ng-model="ListName" required>
                                                            <option ng-repeat="item in ListNames">{{item.Title}}</option>
                                                            <option value="">--Select--</option>
                                                        </select>
                                                        <select name="ddlHardList" id="ddlHardList" ng-change="getHardCodeListData(ListHardcodeName)" class="form-control form-control-sm mb-3" ng-model="ListHardcodeName" required>
                                                            <option value="ITComments">IT Comments</option>
                                                            <option value="SystemAccessComments">System Access Comments</option>
                                                            <option value="ITRequests">IT Requests</option>
                                                            <option value="">--Select--</option>
                                                        </select>
                                                    </div>
                                                    <div class="col-md-2 column">
                                                        <a class="form-control form-control-sm mb-3" style="background-color:#ffce00;color:#c90207 ;border: none;" ng-click="ExportExcel()" href="">Export Excel</a>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="table-responsive">
                                                        <table style="display:none" ng-if="IsITComments||IsSystemAccessComments" class="table table-bordered table-hover" id="{{ListHardcodeName}}">
                                                            <thead>
                                                                <tr>
                                                                    <th>User Comments</th>
                                                                    <th>CommentsBy</th>
                                                                    <th>Created Date</th>
                                                                    <th>Modified Date</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <!-- musubmitted task -->
                                                                <tr ng-repeat="item in ExportListData">
                                                                    <td>{{item.UserComments}}</td>
                                                                    <td>{{item.CommentsBy.Title}}</td>
                                                                    <td>{{item.Created | date : 'dd/MM/yyyy'}}</td>
                                                                    <td>{{item.Modified | date : 'dd/MM/yyyy'}}</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                        <table  style="display:none" ng-if="IsITRequests" class="table table-bordered table-hover" id="{{ListHardcodeName}}">
                                                            <thead>
                                                                <tr>
                                                                    <th>APPLICATION ID</th>
                                                                    <th>APPLICATION TYPE</th>
                                                                    <th>REQUESTER NAME</th>
                                                                    <th>REQUESTED DATE</th>
                                                                    <th>REMARKS</th>
                                                                    <th> LEVEL 1 APPROVER</th>
                                                                    <th> LEVEL 1 APPROVAL DATE</th>
                                                                    <th> LEVEL 2 APPROVER</th>
                                                                    <th> LEVEL 2 APPROVAL DATE</th>
                                                                    <th> LEVEL 3 APPROVER</th>
                                                                    <th> LEVEL 3 APPROVAL DATE</th>
                                                                    <th> LEVEL 4 APPROVER</th>
                                                                    <th> LEVEL 4 APPROVAL DATE</th>
                                                                    <th> IMPLEMENTED BY</th>
                                                                    <th> IMPLEMENTED DATE</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <!-- musubmitted task -->
                                                                <tr ng-repeat="item in ExportListData">
                                                                    <td>{{item.ApplicationID}}</td>
                                                                    <td>IT Service</td>
                                                                    <td>{{item.Author.Title}}</td>
                                                                    <td>{{item.Created | date : 'dd/MM/yyyy'}}</td>
                                                                    <td>{{item.RemarksReasons}}</td>
                                                                    <td>{{item.BranchHead.Title}}</td>
                                                                    <td>{{item.BranchHeadDate}}</td>
                                                                    <td>{{item.ITProjectManager.Title}}</td>
                                                                    <td>{{item.ITProjectManagerDate}}</td>
                                                                    <td>{{item.GroupDirector.Title}}</td>
                                                                    <td>{{item.GroupDirectorDate}}</td>
                                                                    <td>{{item.CIO.Title}}</td>
                                                                    <td>{{item.CIODate}}</td>
                                                                    <td>{{item.ImplementationOfficer.Title}}</td>
                                                                    <td>{{item.ImplementationOfficerDate}}</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                        <!-- dynmaic table -->
                                                        <table style="display:none" class="table table-bordered table-hover" id="ExportXL">
                                                            <thead>
                                                                <tr>
                                                                    <th ng-repeat="lst in ListFields">{{lst.Title}}</th>
                                                                    <th>CREATED BY</th>
                                                                    <th>MODIFIED BY</th>
                                                                    <th>CREATED DATE</th>
                                                                    <th>MODIFED DATE</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <!-- musubmitted task -->
                                                                <tr ng-repeat="item in ExportExcelData">
                                                                    <td ng-repeat="lst in ListFields">{{item[lst.Title]}}</td>
                                                                    <td>{{item.Author.Title}}</td>
                                                                    <td>{{item.Editor.Title}}</td>
                                                                    <td>{{item.Created | date : 'dd/MM/yyyy'}}</td>
                                                                    <td>{{item.Modified | date : 'dd/MM/yyyy'}}</td>
                                                                </tr>
                                                            </tbody>

                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- partial:partials/_footer.html -->
                        <footer class="footer d-flex flex-column flex-md-row align-items-center justify-content-between">
                            <p class="text-muted text-center text-md-left">
                                Copyright © 2020 NPark. All rights reserved
                            </p>
                        </footer>
                        <!-- partial -->
                    </div>
                </div>
                <div ng-show="loaded" class="loading">Loading&#8230;</div>
            </ng-form>
        </div>
    </div>
</body>
</html>