<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">
<head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="../_catalogs/masterpage/eRequest/Apps/StyleLib/Styles/Spinner.css" />
    <!-- ===== Layout Scripts in SharePoint  =========================================================================================== -->
    <script src="/_layouts/15/clientpeoplepicker.js"></script>
    <script src="/_layouts/15/clienttemplates.js"></script>
    <script src="/_layouts/15/clientforms.js"></script>
    <script src="/_layouts/15/sp.runtime.js"></script>
    <script src="/_layouts/15/autofill.js"></script>
    <script src="/_layouts/15/sp.js"></script>

    <script type="text/javascript" src="/_layouts/15/init.js"></script>
    <script type="text/javascript" src="/_layouts/15/1033/strings.js"></script>
    <script type="text/javascript" src="/_layouts/15/core.js"></script>

    <!-- ===== Custom Scripts in Master  =========================================================================================== -->
    <script src="../_catalogs/masterpage/eRequest/Apps/app.js"></script>
    <script src="../_catalogs/masterpage/eRequest/Apps/baseSvc.js"></script>
    <script src="../_catalogs/masterpage/eRequest/Apps/commonSvc.js"></script>
    <script src="../_catalogs/masterpage/eRequest/Apps/utility.js"></script>
    <script src="../_catalogs/masterpage/eRequest/Apps/Admin/ITAdminDashboardController.js"></script>
    <script src="../_catalogs/masterpage/eRequest/Apps/Admin/ITAdminDashboardService.js"></script>
    <script src="../_catalogs/masterpage/eRequest/Apps/StyleLib/Js/jquery.table2excel.min.js"></script>
    <!-- ===== Date Picker-jquery-ui.css  =========================================================================================== -->
    <style type="text/css">

        body {
            font-family: "Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif;
        }

        .container {
            width: 100% !important;
        }

        label {
            display: inline-block;
            /* max-width: 100%; */
            margin-bottom: 5px;
            font-weight: 500;
            /* text-align: left; */
            /* font-size: 12px; */
        }

        .odd {
            background-color: #afb5ff;
        }

        .even {
            background-color: #ccc;
        }

        .sort-icon {
            font-size: 9px;
            margin-left: 5px;
        }

        th {
            cursor: pointer;
        }

        .active {
            color: #023509 !important
        }

        h4, .ms-h4 {
            font-size: 1.7em;
            color: #262626;
        }
    </style>
    <style>

        .pagination a {
            color: black;
            float: left;
            padding: 8px 16px;
            text-decoration: none;
            transition: background-color .3s;
            border: 1px solid #ddd;
        }

            .pagination a.active {
                background-color: #4CAF50;
                color: white;
                border: 1px solid #4CAF50;
            }

            .pagination a:hover:not(.active) {
                background-color: #ddd;
            }
    </style>
    <style>
        .arrow {
            border: solid black;
            border-width: 0 3px 3px 0;
            display: inline-block;
            padding: 3px;
        }

        .right {
            transform: rotate(-45deg);
            -webkit-transform: rotate(-45deg);
        }

        .left {
            transform: rotate(135deg);
            -webkit-transform: rotate(135deg);
        }

        .up {
            transform: rotate(-135deg);
            -webkit-transform: rotate(-135deg);
        }

        .down {
            transform: rotate(45deg);
            -webkit-transform: rotate(45deg);
        }
    </style>
    <style>
        #ui-datepicker-div.ui-datepicker .ui-widget-header {
            border: 1px solid #aaa;
            background: #e9e9e9;
            color: #ffffff;
            font-weight: bold;
        }

            #ui-datepicker-div.ui-datepicker .ui-state-hover, #ui-datepicker-div.ui-datepicker.ui-widget-content .ui-state-hover, #ui-datepicker-div.ui-datepicker .ui-widget-header .ui-state-hover {
                border: 1px solid #ccc;
                background: #ededed;
                color: #2b2b2b;
            }

                #ui-datepicker-div.ui-datepicker .ui-state-hover .ui-icon {
                    background-image: url(images/ui-icons_222222_256x240.png)
                }

            #ui-datepicker-div.ui-datepicker .ui-widget-header .ui-icon {
                background-image: url(images/ui-icons_222222_256x240.png)
            }

        #ui-datepicker-div.ui-datepicker .ui-state-default, #ui-datepicker-div.ui-datepicker.ui-widget-content .ui-state-default {
            color: rgb(0,69,126);
        }

        #ui-datepicker-div.ui-datepicker .ui-widget-header select, #ui-datepicker-div.ui-datepicker.ui-helper-clearfix select {
            font-weight: normal;
            display: inline;
            height: auto;
            margin: 1px 0;
            padding: 0;
            -webkit-appearance: menulist;
            -moz-appearance: menulist;
            background-image: none;
        }

        #ui-datepicker-div.ui-datepicker .ui-datepicker-prev-hover, #ui-datepicker-div.ui-datepicker .ui-datepicker-next-hover {
            top: 2px;
        }

        #ui-datepicker-div.ui-datepicker .ui-datepicker-prev-hover {
            left: 2px;
        }

        #ui-datepicker-div.ui-datepicker .ui-datepicker-next-hover {
            right: 2px;
        }
    </style>
    <script>
        $(function () {
            var dateToday = new Date();
            $("#ApplicationDate").datepicker({
                changeMonth: true,
                changeYear: true,
                dateFormat: 'dd/mm/yy'

            });
            $("#ApplicationEndDate").datepicker({
                changeMonth: true,
                changeYear: true,
                dateFormat: 'dd/mm/yy'
            });
        });
    </script>
</head>
<body>
    <div ng-app="eRequestApp">
        <div ng-controller="ITAdminDashboardController" ng-init="init()">
            <ng-form name="appForm" ng-app novalidate>
                <!-- Main Section -->
                <div class="main-wrapper">
                    <!-- partial:partials/_sidebar.html -->
                    <nav class="sidebar">
                        <div class="sidebar-header">
                            <a href="#" class="sidebar-brand">
                                <img src="../_catalogs/masterpage/eRequest/Apps/StyleLib/Images/logo.png" alt="" class="img-fluid" style="padding:35px">
                            </a>
                            <div class="sidebar-toggler not-active">
                                <span></span>
                                <span></span>
                                <span></span>
                            </div>
                        </div>
                        <div class="sidebar-body">
                            <ul class="nav">
                                <li class="nav-item nav-category">Main</li>
                                <li class="nav-item">
                                    <a target="_parent" href="/erequest/Pages/ITServiceRequest.aspx" class="nav-link">
                                        <i class="link-icon" data-feather="send"></i>
                                        <span class="link-title">New Request</span>
                                    </a>
                                </li>
                                <li class="nav-item ">
                                    <a target="_parent" href="/erequest//Pages/ITServiceDashboard.aspx" class="nav-link">
                                        <i class="link-icon" data-feather="send"></i>
                                        <span class="link-title">Dashboard</span>
                                    </a>
                                </li>
                                <li ng-show="isAdminGroup" class="nav-item ">
                                    <a target="_parent" href="/erequest//Pages/ITAdminDashboard.aspx" class="nav-link">
                                        <i class="link-icon" data-feather="send"></i>
                                        <span class="link-title">Admin Dashboard</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </nav>
                    <!-- partial -->
                    <div class="page-wrapper">
                        <!-- partial:partials/_navbar.html -->
                        <nav class="navbar">
                            <a href="#" class="sidebar-toggler">
                                <i data-feather="menu"></i>
                            </a>
                            <div class="navbar-content" style="background-color: #fff;">
                                <!--<div class="search-form">
                                    <div style="display:none" class="input-group">
                                        <div class="input-group-prepend">
                                            <div class="input-group-text">
                                                <i data-feather="search"></i>
                                            </div>
                                        </div>
                                        <input type="text" class="form-control" id="navbarForm" placeholder="Search here...">
                                    </div>
                                </div>-->
                                <ul class="navbar-nav">
                                    <li class="nav-item dropdown nav-profile">
                                        <a class="nav-link dropdown-toggle" href="#" id="profileDropdown" role="button" data-toggle="dropdown"
                                           aria-haspopup="true" aria-expanded="false">
                                            <img src="../_catalogs/masterpage/eRequest/Apps/StyleLib/Images/faces/face1.jpg" alt="profile">
                                        </a>
                                        <div class="dropdown-menu" aria-labelledby="profileDropdown">
                                            <div class="dropdown-header d-flex flex-column align-items-center">
                                                <div class="figure mb-3">
                                                    <img src="../_catalogs/masterpage/eRequest/Apps/StyleLib/Images/faces/face1.jpg" alt="">
                                                </div>
                                                <div class="info text-center">
                                                    <p class="name font-weight-bold mb-0">Hi {{appProperties.CurrentUser.Title}}</p>
                                                    <p class="email text-muted mb-3">{{appProperties.CurrentUser.Email}}</p>
                                                </div>
                                            </div>
                                            <div ng-show="isSiteAdmin" class="dropdown-body">
                                                <ul class="profile-nav p-0 pt-3">
                                                    <li class="nav-item">
                                                        <a target="_parent" href="/erequest/_layouts/15/viewlsts.aspx" class="nav-link">
                                                            <i data-feather="edit"></i>
                                                            <span>Site Contents</span>
                                                        </a>
                                                    </li>
                                                    <li class="nav-item">
                                                        <a target="_parent" href="/erequest/_layouts/15/settings.aspx" class="nav-link">
                                                            <i data-feather="log-out"></i>
                                                            <span>Site Settings</span>
                                                        </a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </nav>
                        <!-- partial -->
                        <div class="page-content">
                            <h4>Dashboard</h4>

                            <div class="row">
                                <div class="col-md-3">
                                    <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                                        <li class="nav-item">
                                            <input type="button" class="nav-link active" id="home-tab" data-toggle="tab" role="tab" ng-click="getAllData()" aria-controls="home" aria-selected="true" value=" All" />
                                            <!--<a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#all" role="tab" ng-click="getOnGoing()" aria-controls="pills-profile" aria-selected="false">On Going</a>-->
                                        </li>
                                        <li class="nav-item">
                                            <input type="button" class="nav-link" id="ongoing-tab" data-toggle="tab" role="tab" value="Ongoing" ng-click="getOnGoing()" aria-controls="ongoing" aria-selected="false" />
                                            <!--<a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pending" role="tab" ng-click="getClosed();" aria-controls="pills-home" aria-selected="true">Closed</a>-->
                                        </li>
                                        <li class="nav-item">
                                            <input type="button" class="nav-link" id="close-tab" data-toggle="tab" value="Closed" role="tab" ng-click="getClosed()" aria-controls="close" aria-selected="false" />
                                            <!--<a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pending" role="tab" ng-click="getClosed();" aria-controls="pills-home" aria-selected="true">Closed</a>-->
                                        </li>
                                    </ul>
                                </div>
                                <div class="col-md-2"><div class="dataTables_length form-group row" id="dataTableExample_length"><label>Show <select ng-change="search()" name="dataTableExample_length" ng-model="itemsPerPage" aria-controls="dataTableExample" class="custom-select custom-select-sm form-control"><option value="10">10</option><option value="30">30</option><option value="50">50</option><option value="">All</option></select> entries</label></div></div>
                                <div class="col-md-3"><label> </label> <input type="text" ng-model="searchText" ng-keyup="search(ITServiceRequestData)" class="form-control" placeholder="Search" aria-controls="dataTableExample"></div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="">From Date</label>
                                        <input type="text" name="ApplicationDate" placeholder="DD/MM/YYYY" ng-model="appProperties.ApplicationDate" id="ApplicationDate" class="form-control" required>

                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="">To Date</label>
                                        <input class="form-control" placeholder="DD/MM/YYYY" ng-model="appProperties.ApplicationEndDate" name="ApplicationEndDate" id="ApplicationEndDate" />

                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                                        <li class="nav-item">
                                            <input class="nav nav-pills mt-4" style="background-color:#ffce00;color:#c90207 ;border: none;border-radius: 0.25rem" ng-click="search(ITServiceRequestData)" type="button" value="Search">
                                        </li>

                                        <li class="nav-item">
                                            <input class="nav nav-pills mt-4" style="background-color:#ffce00;color:#c90207 ;border: none;border-radius: 0.25rem" ng-click="celarsearch()" type="reset" value="Reset">
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                                    <li class="nav-item">
                                        <input class="nav nav-pills mt-4" style="background-color:#ffce00;color:#c90207 ;border: none;" ng-click="ExportExcel()" type="button" value="Export">
                                    </li>


                                </ul>
                            </div>

                            <div class="tab-content" id="pills-tabContent">

                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="card">
                                            <div class="card-body">
                                                <div class="table-responsive">
                                                    <table class="table table-bordered table-hover">
                                                        <thead>
                                                            <tr>
                                                                <th class="ID" custom-sort order="'ID'" sort="sort">APPLICATION ID</th>
                                                                <th>APPLICATION TYPE</th> <!--hardcode for display purpouse-->
                                                                <th class="Author.Title" custom-sort order="'Author.Title'" sort="sort">REQUESTER NAME</th>
                                                                <th class="Created" custom-sort order="'Created'" sort="sort">REQUESTED DATE</th>
                                                                <th class="WorkAreadCode" custom-sort order="'WorkAreaCode'" sort="sort">TYPE OF REQUEST</th>
                                                                <th class="RequestTypeCode" custom-sort order="'RequestTypeCode'" sort="sort">REQUEST FOR</th>
                                                                <th class="WorkFlowStatus" custom-sort order="'WorkFlowStatus'" sort="sort">APPLICATION STATUS</th>
                                                                <th> REQUEST PENDING WITH</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <!-- musubmitted task -->
                                                            <tr ng-repeat="item in pagedItems[currentPage] |orderBy:sort.sortingOrder:sort.reverse">
                                                                <td><a target="_self" href="/erequest/Pages/ITServiceRequest.aspx?ReqId={{item.ID}}">{{item.ApplicationID}}</a></td>
                                                                <td>IT Service</td>
                                                                <td>{{item.Author.Title}}</td>
                                                                <td>{{item.Created | date : 'dd/MM/yyyy'}}</td>
                                                                <td>{{getWorkAreadCode(item.WorkAreaCode)}}</td>
                                                                <td>{{getReqType(item.RequestTypeCode)}}</td>
                                                                <td>{{getStatus(item.WorkFlowStatus)}}</td>
                                                                <td>
                                                                    <a href="#my_modal" data-toggle="modal" data-id="{{item.Id}}">{{getWFStatus(item)}}</a>
                                                                </td>
                                                            </tr>
                                                            <tr ng-show="filteredItems.length>itemsPerPage">
                                                                <td colspan="8">
                                                                    <nav class="pull-right">
                                                                        <ul class="pagination justify-content-end  mt-2">
                                                                            <li ng-class="{disabled: currentPage == 0}">
                                                                                <a href="#" ng-click="prevPage()">&laquo; Prev</a>
                                                                            </li>
                                                                            <li ng-repeat="n in range(pagedItems.length, currentPage, currentPage + gap) " ng-class="{active: n == currentPage}" ng-click="$parent.currentPage = n;">
                                                                                <a href="#" ng-bind="n + 1">1</a>
                                                                            </li>


                                                                            <li ng-class="{disabled: (currentPage) == pagedItems.length - 1}">
                                                                                <a href="#" ng-click="nextPage()">Next &raquo;</a>
                                                                            </li>
                                                                        </ul>
                                                                    </nav>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td colspan="8">
                                                                    <span ng-hide="pagedItems.length>0">No records found</span>
                                                                </td>
                                                            </tr>
                                                        </tbody>

                                                    </table>


                                                    <table class="table table-bordered table-hover" id="ExportXL" style="display:none">
                                                        <thead>
                                                            <tr>
                                                                <th class="ID" custom-sort order="'ID'" sort="sort">APPLICATION ID</th>
                                                                <th class="ID" custom-sort order="'ID'" sort="sort">APPLICATION TYPE</th> <!--hardcode for display purpouse-->
                                                                <th class="Author.Title" custom-sort order="'Author.Title'" sort="sort">REQUESTER NAME</th>
                                                                <th class="Created" custom-sort order="'Created'" sort="sort">REQUESTED DATE</th>
                                                                <!--<th class="WorkAreadCode" custom-sort order="'RequestTypeCode'" sort="sort">TYPE OF REQUEST</th>-->
                                                                <th class="WorkAreadCode" custom-sort order="'WorkAreadCode'" sort="sort">TYPE OF REQUEST</th>
                                                                <th class="RequestTypeCode" custom-sort order="'RequestTypeCode'" sort="sort">REQUEST FOR</th>
                                                                <th class="Remarks" custom-sort order="'Remarks'" sort="sort">REMARKS</th>
                                                                <th class="WorkFlowStatus" custom-sort order="'WorkFlowStatus'" sort="sort"> APPLICATION STATUS</th>
                                                                <th> REQUEST PENDING WITH</th>
                                                                <th> LEVEL 1 APPROVER</th>
                                                                <th> LEVEL 1 APPROVAL DATE</th>
                                                                <th> LEVEL 2 APPROVER</th>
                                                                <th> LEVEL 2 APPROVAL DATE</th>
                                                                <th> LEVEL 3 APPROVER</th>
                                                                <th> LEVEL 3 APPROVAL DATE</th>
                                                                <th> LEVEL 4 APPROVER</th>
                                                                <th> LEVEL 4 APPROVAL DATE</th>
                                                                <th> IMPLEMENTED BY</th>
                                                                <th> IMPLEMENTED DATE</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <!-- musubmitted task -->
                                                            <tr ng-repeat="item in ITServiceRequestData">
                                                                <td>{{item.ApplicationID}}</td>
                                                                <td>IT Service</td>
                                                                <td>{{item.Author.Title}}</td>
                                                                <td>{{item.Created | date : 'dd/MM/yyyy'}}</td>
                                                                <td>{{getWorkAreadCode(item.WorkAreaCode)}}</td>
                                                                <td>{{getReqType(item.RequestTypeCode)}}</td>
                                                                <td>{{item.RemarksReasons}}</td>
                                                                <td>{{getStatus(item.WorkFlowStatus)}}</td>
                                                                <td>{{getWFStatus(item)}}</td>
                                                                <td>{{item.BranchHead.Title}}</td>
                                                                <td>{{item.BranchHeadDate}}</td>
                                                                <td>{{item.ITProjectManager.Title}}</td>
                                                                <td>{{item.ITProjectManagerDate}}</td>
                                                                <td>{{item.GroupDirector.Title}}</td>
                                                                <td>{{item.GroupDirectorDate}}</td>
                                                                <td>{{item.CIO.Title}}</td>
                                                                <td>{{item.CIODate}}</td>
                                                                <td>{{item.ImplementationOfficer.Title}}</td>
                                                                <td>{{item.ImplementationOfficerDate}}</td>
                                                            </tr>
                                                        </tbody>

                                                    </table>




                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="tab-pane fade" id="ongoing" role="tabpanel" aria-labelledby="pills-contact-tab">...</div>
                                <div class="tab-pane fade" id="closed" role="tabpanel" aria-labelledby="pills-contact-tab">...</div>
                            </div>
                        </div>
                        <!-- partial:partials/_footer.html -->
                        <footer class="footer d-flex flex-column flex-md-row align-items-center justify-content-between">
                            <p class="text-muted text-center text-md-left">
                                Copyright © 2020 NPark. All rights reserved
                            </p>
                        </footer>
                        <!-- partial -->
                    </div>
                </div>



                <div class="modal" id="my_modal">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div style="display:none;" class="pull-right">
                                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label for="my-input">Delegate Approver Name</label>
                                    <input type="text" class="form-control" style="visibility:hidden" id="username" ng-model="appProperties.DelegateUser.Title" disabled />
                                    <div title="peoplePickerDelegateUser" id="peoplePickerDelegateUser"></div>
                                </div>                             
                            </div>
                            <div class="modal-footer">
                                <input id="btnSubmitRequest" class="frmbutton" value="Submit" ng-click="submitITServiceRequest(1,$event,appForm)" type="button" />
                                <button class="btn btn-warning" type="button" data-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
              
                <div ng-show="loaded" class="loading">Loading&#8230;</div>
            </ng-form>
    </div>
    </div>
</body>
</html>